# Intro To Cryptography

by Joseph Surin

- Brief overview of important mathematical concepts and notation relevant to modern cryptography.
- Overview of some functions from the popular [PyCrypto](https://www.dlitz.net/software/pycrypto/) cryptography library for Python.
- Overview of the purposes of cryptography and the types of cryptosystems.
- Examples of some basic cryptosystems.
- Introduction to RSA with examples

## Challenges

The number of points indicates relative difficulty. Try the lower point challenges first and work your way up! The aim of each challenge is to find the flag which will be in the format `MISCCTF{a-zA-Z0-9!?_-}`

### RSA Level 0 (10 points)

> Practice makes perfect...
> 
> ```python
> p = 124031229518274089467199323794612026514016300057524881922409337685859302740210859310434145018807354401258020965854467248902493582170738605174780962956665385730816421801545005802516958789993408612669863243661901410969476844103177369498342800665476481306495082558255442200116321602944990572622609952865007955187
> q = 154935967506143898675399614490708584844526382221519824561160286717597311026747507385484960980752551485904038607409980479359995970051663865812242507217978975735560739540212774087685961958280245901471164248414502557727850745849574640143649771425879263662690010607541395611510698535721016955649979229379387360627
> e = 65537
> c = 10214861892120445865706385867011587127982045085961862823092044304305939552393842554545454239786761326736651737891182342548588924080704628751092756140318269823467049441874858968317487329891259238315363624456336080755478927026710723688585757247557931475102582577748644922975623505161093260928142607959549309978930068369267414123151654788124670818474772668793649593871423650063919771786368027770837971886168517190007399980700311805376224527838285697981316120969399711890612253130626678712362973178914520342831921909615107294366566624156568568106436986386109053466371294944512232622369387736598408368770428882577777409409
> ```

---

### RSA Level 1 (15 points)

> Is there anything noteworthy about `n`?
>
> ```python
> n = 64102002301840754228195419684105688294791204377114921273193411967543960790809
> e = 65537
> c = 59275256886013998614804534443446044923122093593042100696977962063455729483055
> ```

---

### RSA Level 2 (15 points)

> `e = 3` is _usually_ fine...
> 
> ```python
> n = 16401882646637440620953541991941059259546430040210104630438059046138795628916305134169476566074874418388269976985559389427040690366478494051748806288987123045536130338315208871168443599248054950321387254361087589217960527034446793466002784904041217219770651699544390152230321384711740808621720733496498596867352335244606022811922353343554492572954925881845943430367868346430081327724481441368174098482311965377003859415475508584004125677369216141900338772891759057279475972234781146547566619914355394021555457568364774921941104433049284890488776971193194840250323981190014772420108568732618004400164828876793330976061
> e = 3
> c = 201737273766207370327106420047730442667612191819299238980643112390750490891471051693905353206053730807713093675363711775936659616145387086361658212573285870814444886971152648090921403537377686764833516910877165338196990531988075336362030375677416442213
> ```

---

### RSA Level 3 (25 points)

> I'm trying to send a secret message to three of my friends... Am I doing it right?
>
> The values are:
> 
> ```python
> n1 = 129355032492799328711770690437062522346822450100516850871735060091731234360182478168962232803929911501891552506088749667784905337810377588408831542388350839544017354874519658729033674370110074550264387756945237198420646881349438293924905748335216575066645702542844426131859232021944857798327092165169555552567
> n2 = 157525734603910067247633997788204015842820913753372807041889968767533250747419008252281584522678525192010743753669708378491315345443318440545419455834211202019945379362843367041092971295213906349314972038862037651592986722702690211660976001726008494646155971253934866911797248790043755307845178217725286355827
> n3 = 143640948631525479437645164021085886887395776392402462543781367126601894377964419121319755950121404763284071143031713173842514412340252946980434023234244296946950749623233798415310169640405447463920053005906463666068392037218388529956490372778875797295618298096822397054887990335006805325477815401948387884239
> c1 = 124957342103178424340167786400225330184498621209037697676290220525847963496520922941282619420788470502664091764434711719771140967580423331385123074944548017223721250099412268074944384048515557279223306507214709734398593619863142919708949407353109061481013301816680744136784377446494004386539627962420458339467
> c2 = 115909990402687502246882313025611661705397788047025907022689547272679479285567403871989700552170150299791450000749382440837833464847816029797319311008216751196607213134863972583641796269169769411823159677283251656986856356781801740421999806125406954152047375431566777530014368692357227389134657129912022427359
> c3 = 51070982055268525571074549703343359862631927280943080809056592877924518831806879509840548189365692361614644361286466710979878939965464156272893089392578836973415404739635882120356434944834882744869263377699181114248958867301709196089845119463238841057430721599449228479502256377831939472376592279446650492071
> ```
> 
> ```python
> from Crypto.Util.number import getPrime, bytes_to_long
> from math import gcd
> 
> n1, n2, n3 = getPrime(1024), getPrime(1024), getPrime(1024)
> assert(gcd(n1, n2) == gcd(n1, n3) == gcd(n2, n3) == 1)
> e = 3
> 
> flag = b'MISCCTF{this is not the flag by the way}'
> m = bytes_to_long(flag)
> 
> c1, c2, c3 = pow(m, e, n1), pow(m, e, n2), pow(m, e, n3)
> ```

---

### RSA Level 4 (30 points)

> I've learnt my lesson about small public exponents...
>
> The values are:
> 
> ```python
> c = 9090963146511093696571618903288714964563822206739107621112655554807150895316778689131194043185906495615242857937801193437991135926897216593165172594829677670080976417994476610627876787617934612247133407221611741265125803378712082069728542696196808389231508987946795394151802961857889807737263228507163143982133257997019716923055583586831557004777689080696115502503959718174139619969464579092274545494854631129279198244285229540875887705365456363951215781196263714624232768194711793341742626391104168713487905476103057527968547426053959581073640033771490523325132922400837566575032977419116594809804314817117291139269
> n = 17982370786131601915950841145582900959164434395775132572730285599269970759570902513529356273971194825458877195853382713374348723403529975173100163375065460398296394186886729020783615050422990349637156965655001511190121025786861862039502058919484806028043243145524357781368729400601458621572239957485192411443063957468529352264159311942421115048705924450761954734604914652197375944204793297255304619159144576620495222823044847191417000775703968066742499462236867781092208539224075416186000395840739932008466393499109192913696379077070535084208138886438351988742462345199352587301741981465623213021475044762619707268747
> ```
> 
> ```python
> from Crypto.Util.number import getPrime, bytes_to_long
> flag = b'MISCCTF{i dont think this is the flag}'
> assert(len(flag) < 50)
> 
> p, q = getPrime(1024), getPrime(1024)
> n = p * q
> e = 3
> 
> padded = flag.ljust(256, b'\\x00')
> m = bytes_to_long(padded)
> 
> c = pow(m, e, n)
> ```

---

### RSA Level 5 (25 points)

> Two values of `e` but only one `n`
>
> The values are:
> 
> ```python
> c1 = 1994005095264230639078240620330820086336292621149741215282336169259972597646679172251077206331581339109568653631881455268262814865402652920018489979224019686836773575565296210700545030485434230074040520554561080242280139797053527724242563577272253605174501420684009751063904095608303319390689084741362752214515485615605456899702439772283161070494010259021677257159316530914684247742590327180468186143838668124552947944108854033365032797989894304921700290961829119090773028377323394253499060661578536707560734212878862575220670154583145702849505966831551010656569107909232232161724324044529153271214250854309094544225
> c2 = 5353119502606201115015065165170690421744681507558948210836318468172849084596403772824578698317702474243495671204030021955215120159695938751100180354641659867978711184804790151879728399866865430082159680829426399618454736038330425369515653941062954782418866298950155729227751420239661116866857856417156929300238355100384076708966880786725066923593318946704150111968533860620476292999154098440146534560713036450431830801551713233409342006653945874633678437114061430951666951328468149463814277461354244545398358662573429128623069139984729699617897826706746486773325280625640849156739844301091605241766569090256202371205
> n = 16011363356501252215969454490889890369074753138087704711401700386241111629239371875325134075006859509901723156265869907427943809549357926054281406657581045775728522945157810345581241387734244106988046781094581484731833763124641910309248970411591006661772820230797713347315532556903454351291189233922800539236151242279496356411953885729332800628766713594357553340132681653642532948857897964413268524435635807472823722691082164899748692152503779064620851640077190539557260716799483655036437473882115578485300650642904653701825794952322269636659149798639663933179262223667628946579671087510819905258888165509823421047633
> e1 = 17489
> e2 = 65537
> ```
> 
> ```python
> from Crypto.Util.number import getPrime, bytes_to_long
> 
> flag = b'MISCCTF{this is not the flag by the way}'
> 
> n = getPrime(1024) * getPrime(1024)
> 
> e1 = 17489
> e2 = 65537
> 
> m = bytes_to_long(flag)
> 
> c1 = pow(m, e1, n)
> c2 = pow(m, e2, n)
> ```

---

### RSA Level 6 (20 points)

> Is there anything that seems out of the ordinary?
>
> The values are:
> 
> ```python
> e = 0x10001
> n1 = 18818192509690892621328667676806510011090400695408843418793627713062468584644663139444724331240564898573585491713497953219199749240525816041563891139166016518270774940997653532129600187590812681068353216877092980478593275332752408440153562123927609532286837103797666509104780100522497480750632470326962154703484733299858128457149810745639229000674703193799224699760653265743204453756457037645321969465453598517090764540494686255227125092400130269268576489528717465995207524070282342204851090856236287113656930711856342642210065762867024090590314862732965417134738950588408996511769679706319053473101474081146228112213
> n2 = 17453044926400224006420256395647110171823368547145004879148082329299607089334057832628103021872156761833719732564290277553615489982088022729027188212459823209705972017571337221859251982251664305070347226229447827385335228365489105916656194938393639051459929202969317256179552025262960156705831280559491523014259118607566335558355933682819411653798101804924965307447600062599059675454229576165102736784201108514383026531257528612658416478023092306682151151741167861334407162817064565122431712943367527524943671708088182279345748777269671424379911170291379498900222528976246433714210353981267245039167179310551073053661
> c1 = 4800498991334649578450908511888687560536306599893514190228679820110221318150667712127819315533341373830905483223892768948675344756482131042992292718747864431513169250318050298555435855959384067472746802883856877349809651427883105471941281570664938544244255934243325552985116129414292883791523860004886097941404074545989682099759525169615360513483628784420787759532680817760375021647688801039900376768135628727719784969283347664963071361008012106999820454149718486222489837974621331640021113983760064708736783227178164567025979503241319515207786006344409850660563311162037912083566021690017341297972281191859928982813
> c2 = 2915973786476412904909455324803142678595003808716621775614116304526861570915169393926021604512518639764031949790555820805110636099947491111802774694018600046607160753789782841333763347522926946679361760664866734298113948730361992074643474879204185388735710651868092513476807500335531535268190107622518026587541948528288526415743712488756612844199957682193287025103850045517584629981222188364313409289621952394255012680854349946781464293466169359391785144017267250616789020457848011372453704098530570870662445885762798984856761488284344715728860468404603351775411629622531393983583051507812925490729289748077544570478
> ```
> 
> ```python
> from Crypto.Util.number import getPrime, bytes_to_long
> 
> flag = b'MISCCTF{this is not the flag by the way}'
> 
> e = 0x10001
> p1 = getPrime(1024)
> p2 = p1
> q1 = getPrime(1024)
> q2 = getPrime(1024)
> n1 = p1 * q1
> n2 = p2 * q2
> 
> m = bytes_to_long(flag)
> 
> c1 = pow(m, e, n1)
> c2 = pow(m, e, n2)
> ```

---

### RSA Level 7 (30 points)

(Only available on the Discord Bot)

---

### RSA Level 8 (40 points)

> RSA... RSA...
> Output of the below script is:
> 
> ```python
> e=17
> N=29072915015987835151558981639840549368229311077012681604906159633835426538843193483031807762640437228465522144558515921636259082975271404488922658617068823127999610183750387201283992285149149721235450689856828685677788546435039749751359116430664854274811380211177183142639110784894666377203536271618155779441226308976179795597191775300698415316686297579705963162122108385191531931186009562074796174784580178004717305968524210761187527616949390014885985050543159604845092271001893049075801294744096538400815346767857488452536831199439269824109029619414211846892013717626041458694995784878237538359411478360631419589477
> b=6308546452812460518460214894206417447327577667441349978341622825979571148532362921025016732126272308111469485554863912318564752393143734865203457040426469718101544606330622917353397819554607897913394565533992207414897398896355610874144145825654241850191370159307654133646007295462741171032061339430838303532167205897094266422438521338138078593005115946853903757262934207102054733491147232856235972023007863175607700388516460010116189764555620250889014673003135921834103987872524956914981161514373950776155843489212614330325001522600322028222694106153120031575082734983236282730353874816101453979990158272331070238682726746740528763087244771886046979683491052898933124418775798251
> C1=9934977864076989246103978671107202294184119225286119211515380255309323178790761701022561126831700321588001676400330371097679555295188489011278466338319054019799391568318755012221416769391656996304930697295843218838974154547438552260159423367088375786418467439780383740467758445152308309957288382608592323584146871048778581821593902388194631162641727907631213391812169209156110462005619485132739274907591231326723046317037133397847359331599269795178579634409424945052453706964947062567763952635456043637048654112383190981518622169108357438765404241674120777812048145677731945258813067164940251135346447607220172607947
> C2=21085169810784887494867834745178338553618929613368842919045044491995327699466196850691253365282340777942003258634460197656960737518180412565860055341286853520292193582748738726067527578745933806348535231485118014290488324636148272156603214796548214466818481135570748681340841396524905008948668644382178384562564107841500837441592781341726831306742931315141252808734144885188723759071710384284245946127954493589601541748693684142851868677726981616832126441112204942177561605313600675983961827048296039909859523082479485497625432165143086753443755903443919784545326014497080305506845242465555500117220831539740618997353
> ```
> 
> ```python
> from Crypto.Util.number import getPrime, bytes_to_long
> 
> N = getPrime(1024)*getPrime(1024) 
> e = 17
> 
> M1 = bytes_to_long(b'MISCCTF{first part of the flag goes here')
> M2 = bytes_to_long(b'second part is here!}')
> b = M1 - M2 + getPrime(208)*N
> 
> C1 = pow(M1, e, N)
> C2 = pow(M2, e,  N)
> print(f'e={e}\\nN={N}\\nb={b}\\nC1={C1}\\nC2={C2}')
> ```

---

### RSA Level 9 (45 points)

> No clues this time! Can you figure out what's going on?
> 
> ```python
> e=65537
> N=17419494277904197345683570011427668413949848844586998167665451023111080100272342955960046708899601149839035215192804422186415271216553353956573238007678513381253976807524239007017245449421835408352906671741485064171162173098930867444383660627288133935406758777717957400069644230794292886992462479648129647841126006162567353456904412137867609644054856373999271787755368452174218686155506308531048668639335364242278858581768045306886968985218457318304175128037602225966626029797087282825490037839655342774221759014550355571509068610038305755448877070470463436685401049207870392433604329609907106345298177904037813358487
> C=13198431897780071961311284180747917614831935724569973044905670330721633148232486296037082703768823526162456030235790833733676451396224000754952519672514440777791504503397561191737864176022913264142970028420739116503260560809864736349395345904511218444725607606907100107579757393318067375680237057901039318036104167989812461027319633504321991142642455932469122701365430340780860986316349724557398954590094186097842682812056481195078986123636110660147893052786629438662941037805463078621886123029412151195102625825687490456077367399741283876865944160281264783793762678103070339148377328916739045480857096361462829691742
> ```
